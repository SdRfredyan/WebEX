PATCH DE SÉCURITÉ : XSS REFLECTED (MEDIA)

Problème :
Le paramètre 'src' n'est pas validé, permettant l'injection de protocoles arbitraires comme 'data:' ou 'javascript:'.

Correction (PHP) :
Implémenter une validation stricte du protocole avant d'afficher le contenu.

---------------- CODE CORRIGÉ ----------------

$src = $_GET['src'];

// 1. Validation (Allow-list) : On accepte uniquement http:// et https://
if (preg_match('/^https?:\/\//', $src)) {
    
    // 2. Assainissement : Protection contre les caractères HTML spéciaux
    $safe_src = htmlspecialchars($src, ENT_QUOTES, 'UTF-8');
    
    echo "<object data='$safe_src'></object>";

} else {
    // Rejet
    http_response_code(400);
    echo "Erreur : Protocole non autorisé.";
}
