SUJET : Remédiation de la faille XSS Stored (Guestbook)

1. ANALYSE DU PROBLÈME
Le formulaire "Feedback" accepte des entrées utilisateur contenant des caractères spéciaux HTML (>, <, ", /) sans les neutraliser correctement. De plus, la longueur des données n'est vérifiée que côté client (attribut maxlength HTML), ce qui est facilement contournable.
Cela permet à un attaquant de fermer les balises du site (ex: </table>) et d'injecter son propre code HTML ou JavaScript.

2. SOLUTIONS TECHNIQUES

A. Échappement des données (Output Encoding) - PRIORITAIRE
C'est la défense la plus efficace. Avant d'afficher le commentaire sur la page, le serveur doit convertir les caractères spéciaux en entités HTML inoffensives.

Code PHP recommandé :
// Au lieu de : echo $comment;
echo htmlspecialchars($comment, ENT_QUOTES, 'UTF-8');

Cela transforme : </td><script>
En : &lt;/td&gt;&lt;script&gt; (qui s'affiche comme du texte mais ne s'exécute pas).

B. Validation côté serveur (Input Validation)
Ne jamais faire confiance à la limitation "maxlength" du HTML. Le serveur doit revérifier la taille de la chaîne reçue.

Code PHP recommandé :
if (strlen($_POST['message']) > 50) {
    die("Message trop long");
}

C. Content Security Policy (CSP)
Mettre en place un en-tête HTTP "Content-Security-Policy" pour interdire l'exécution de scripts inline (scripts écrits directement dans le HTML) et n'autoriser que les scripts provenant du domaine de confiance.

Exemple Header :
Content-Security-Policy: default-src 'self'; script-src 'self';
